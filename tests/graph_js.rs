use gt_graph_wasm::GraphJS;

use wasm_bindgen_test::*;

#[wasm_bindgen_test]
async fn test_from_url() {
    let url = "https://networks.skewed.de/net/advogato/files/advogato.gt.zst".to_string();

    // Create a promise that is ready on the next tick of the micro task queue.
    let graph = GraphJS::from_url(url).await.unwrap();

    assert_eq!(graph.num_vertices(), 6541);
    assert_eq!(graph.num_edges(), 51127);
}

#[wasm_bindgen_test]
async fn test_from_netzschleuder() {
    let network = "advogato".to_string();
    let sub_network = Some("advogato".to_string());

    // Create a promise that is ready on the next tick of the micro task queue.
    let graph = GraphJS::from_netzschleuder(network, sub_network)
        .await
        .unwrap();

    assert_eq!(graph.num_vertices(), 6541);
    assert_eq!(graph.num_edges(), 51127);
}

#[wasm_bindgen_test]
async fn test_from_data() {
    //Read data from file
    let data = vec![
        40, 181, 47, 253, 0, 104, 101, 89, 0, 42, 146, 24, 34, 79, 0, 84, 74, 2, 140, 23, 143, 236,
        9, 192, 243, 37, 204, 145, 190, 0, 124, 14, 202, 87, 247, 72, 140, 226, 105, 192, 71, 232,
        158, 78, 120, 18, 112, 195, 231, 79, 67, 105, 82, 77, 250, 110, 231, 212, 62, 145, 122,
        210, 242, 248, 187, 219, 64, 246, 32, 35, 190, 51, 51, 115, 135, 84, 150, 48, 146, 17, 157,
        17, 34, 129, 236, 166, 241, 232, 239, 178, 32, 219, 1, 228, 1, 184, 1, 75, 2, 50, 240, 211,
        244, 89, 247, 105, 64, 181, 218, 93, 153, 204, 46, 103, 187, 242, 55, 202, 230, 117, 107,
        14, 213, 95, 24, 67, 121, 102, 207, 112, 23, 86, 190, 155, 189, 158, 209, 188, 197, 48,
        115, 235, 102, 155, 249, 12, 38, 252, 244, 228, 111, 11, 3, 27, 195, 176, 17, 172, 73, 13,
        74, 230, 171, 202, 51, 254, 222, 175, 170, 106, 252, 84, 223, 253, 75, 232, 203, 241, 115,
        221, 62, 19, 187, 252, 233, 92, 191, 13, 191, 147, 25, 134, 153, 140, 238, 179, 203, 188,
        223, 93, 203, 176, 251, 100, 76, 152, 125, 169, 110, 177, 219, 164, 157, 175, 11, 188, 53,
        87, 215, 52, 220, 174, 216, 221, 207, 213, 167, 234, 190, 218, 230, 157, 63, 26, 205, 90,
        197, 223, 190, 234, 226, 166, 198, 108, 91, 183, 241, 111, 241, 63, 209, 134, 244, 90, 189,
        242, 232, 186, 85, 247, 153, 238, 10, 117, 159, 237, 61, 52, 183, 71, 173, 45, 175, 46, 46,
        177, 22, 197, 35, 17, 88, 216, 139, 99, 81, 241, 232, 107, 1, 22, 102, 164, 44, 134, 241,
        128, 237, 20, 143, 70, 68, 31, 145, 21, 86, 214, 214, 177, 75, 235, 74, 201, 149, 212, 58,
        114, 109, 249, 172, 174, 182, 142, 90, 201, 36, 86, 150, 210, 74, 235, 120, 133, 149, 85,
        180, 58, 94, 41, 121, 146, 86, 87, 88, 189, 43, 229, 209, 234, 152, 84, 90, 25, 29, 117,
        142, 197, 100, 242, 88, 44, 90, 209, 228, 83, 36, 133, 99, 211, 52, 37, 37, 85, 100, 68,
        20, 101, 60, 58, 42, 34, 18, 21, 137, 136, 68, 72, 62, 1, 122, 72, 190, 0, 116, 144, 124,
        39, 152, 144, 152, 112, 144, 108, 140, 134, 190, 164, 161, 209, 208, 232, 166, 136, 72, 52,
        244, 17, 153, 240, 17, 125, 67, 162, 111, 232, 251, 17, 246, 4, 123, 64, 157, 95, 206, 16,
        142, 208, 141, 9, 223, 13, 142, 79, 206, 141, 13, 175, 140, 39, 181, 227, 163, 122, 71, 49,
        174, 194, 79, 234, 239, 149, 217, 190, 78, 230, 99, 170, 42, 36, 126, 114, 95, 93, 121, 50,
        137, 149, 46, 207, 220, 197, 197, 163, 19, 62, 34, 143, 72, 76, 53, 165, 172, 58, 42, 167,
        144, 24, 137, 217, 119, 12, 191, 79, 52, 252, 180, 98, 74, 10, 105, 149, 108, 74, 97, 190,
        66, 161, 90, 77, 129, 165, 207, 164, 154, 50, 34, 113, 171, 87, 119, 191, 20, 79, 151, 152,
        249, 60, 239, 111, 223, 137, 139, 207, 52, 50, 191, 237, 217, 92, 99, 84, 148, 82, 25, 229,
        252, 153, 2, 63, 187, 54, 241, 116, 231, 118, 93, 98, 86, 107, 14, 245, 140, 230, 237, 228,
        209, 192, 179, 225, 78, 156, 194, 145, 187, 239, 186, 185, 221, 57, 202, 91, 237, 190, 218,
        253, 87, 71, 102, 151, 58, 251, 161, 207, 190, 255, 62, 213, 157, 249, 203, 158, 241, 54,
        247, 76, 217, 28, 254, 175, 235, 106, 246, 183, 126, 238, 168, 121, 79, 191, 185, 223, 41,
        187, 215, 44, 125, 245, 222, 251, 155, 191, 132, 106, 55, 111, 86, 175, 181, 97, 205, 247,
        151, 104, 174, 251, 173, 222, 61, 238, 187, 110, 78, 246, 230, 52, 223, 143, 137, 86, 183,
        206, 220, 99, 110, 221, 138, 109, 105, 110, 181, 115, 191, 94, 207, 249, 111, 102, 171,
        199, 246, 175, 203, 117, 243, 246, 85, 221, 182, 47, 246, 63, 185, 70, 102, 40, 251, 8,
        180, 93, 173, 142, 134, 177, 236, 191, 155, 103, 246, 213, 94, 83, 117, 63, 148, 183, 250,
        44, 71, 255, 169, 250, 222, 95, 153, 236, 218, 190, 15, 127, 233, 111, 175, 247, 215, 231,
        59, 153, 175, 142, 84, 155, 161, 154, 198, 94, 51, 219, 108, 190, 89, 245, 189, 186, 178,
        81, 232, 58, 227, 95, 254, 209, 253, 103, 238, 170, 151, 153, 103, 104, 246, 226, 237, 75,
        159, 253, 167, 250, 254, 240, 253, 210, 60, 198, 223, 221, 217, 191, 50, 119, 110, 255,
        137, 6, 212, 126, 187, 62, 163, 95, 64, 94, 217, 103, 6, 123, 181, 52, 63, 203, 174, 210,
        127, 170, 153, 245, 242, 177, 235, 251, 208, 220, 98, 255, 202, 106, 238, 174, 100, 63,
        133, 106, 86, 247, 184, 107, 150, 238, 23, 123, 243, 47, 179, 251, 66, 198, 131, 245, 158,
        175, 251, 95, 231, 206, 62, 109, 254, 53, 54, 167, 253, 222, 121, 153, 201, 218, 92, 198,
        100, 99, 232, 60, 231, 89, 154, 247, 215, 254, 85, 221, 207, 163, 208, 252, 100, 182, 121,
        235, 229, 139, 105, 178, 7, 115, 221, 231, 237, 171, 191, 126, 126, 175, 154, 117, 230,
        178, 135, 250, 190, 93, 185, 187, 242, 104, 246, 122, 150, 5, 160, 213, 207, 234, 104, 54,
        251, 117, 79, 203, 216, 95, 102, 214, 134, 249, 52, 86, 174, 174, 45, 216, 188, 170, 122,
        6, 144, 235, 204, 60, 243, 204, 228, 223, 70, 181, 107, 15, 125, 170, 43, 244, 53, 178,
        121, 127, 212, 169, 199, 238, 151, 119, 163, 137, 133, 242, 167, 113, 233, 116, 163, 116,
        251, 186, 69, 189, 204, 55, 186, 198, 41, 103, 95, 53, 55, 161, 92, 21, 170, 173, 173, 13,
        63, 25, 139, 83, 86, 86, 82, 41, 112, 87, 25, 126, 98, 230, 15, 112, 118, 104, 112, 20, 52,
        131, 103, 212, 248, 176, 84, 65, 221, 16, 67, 172, 144, 97, 129, 46, 156, 209, 68, 197, 82,
        149, 180, 164, 135, 1, 65, 8, 153, 30, 140, 27, 129, 167, 165, 197, 141, 7, 196, 174, 133,
        50, 209, 46, 28, 94, 97, 69, 163, 176, 197, 13, 209, 250, 185, 17, 210, 133, 191, 4, 188,
        156, 152, 155, 122, 57, 138, 178, 116, 39, 65, 15, 110, 41, 138, 9, 193, 149, 88, 213, 180,
        65, 27, 96, 234, 66, 163, 29, 119, 73, 90, 222, 210, 74, 136, 160, 40, 205, 85, 15, 186,
        29, 232, 72, 242, 204, 43, 47, 76, 12, 177, 133, 116, 96, 148, 33, 102, 48, 184, 204, 180,
        184, 168, 133, 201, 145, 59, 48, 12, 122, 117, 118, 67, 85, 67, 12, 86, 57, 102, 214, 30,
        76, 115, 126, 233, 208, 86, 36, 5, 6, 216, 170, 4, 121, 210, 133, 106, 72, 46, 54, 128,
        239, 171, 0, 101, 196, 211, 212, 131, 190, 185, 4, 156, 122, 52, 137, 157, 89, 195, 241,
        22, 66, 7, 10, 97, 108, 65, 242, 107, 225, 73, 141, 44, 107, 48, 196, 232, 64, 181, 105,
        84, 23, 22, 36, 172, 71, 172, 117, 97, 16, 166, 3, 159, 39, 168, 136, 144, 51, 65, 93, 221,
        2, 54, 75, 200, 58, 144, 71, 198, 151, 38, 107, 216, 24, 118, 98, 88, 7, 72, 233, 63, 28,
        170, 15, 97, 124, 248, 224, 49, 101, 232, 169, 206, 76, 31, 18, 33, 233, 130, 20, 52, 94,
        13, 236, 197, 138, 9, 76, 250, 80, 16, 60, 128, 200, 60, 208, 164, 7, 13, 177, 14, 122, 48,
        162, 255, 130, 96, 169, 250, 125, 33, 101, 104, 69, 140, 12, 112, 125, 168, 139, 13, 56,
        218, 133, 55, 10, 190, 122, 77, 95, 101, 253, 135, 34, 140, 4, 60, 93, 164, 131, 177, 13,
        42, 73, 238, 63, 3, 178, 88, 153, 170, 195, 73, 114, 98, 105, 76, 201, 0, 93, 120, 5, 89,
        134, 8, 26, 184, 168, 5, 189, 205, 157, 248, 234, 194, 227, 10, 116, 77, 148, 124, 80, 222,
        197, 193, 24, 97, 169, 11, 163, 8, 45, 1, 65, 15, 185, 31, 27, 140, 41, 2, 133, 20, 58,
        112, 203, 8, 51, 28, 161, 116, 101, 161, 136, 115, 251, 161, 135, 30, 116, 32, 135, 149,
        170, 160, 115, 185, 148, 130, 192, 180, 245, 161, 144, 130, 44, 103, 75, 84, 176, 110, 16,
        113, 68, 32, 163, 19, 141, 32, 170, 33, 119, 0, 47, 203, 7, 144, 218, 14, 165, 78, 172, 97,
        107, 170, 7, 203, 206, 200, 0, 85, 70, 158, 167, 19, 173, 97, 184, 36, 25, 144, 178, 35,
        226, 228, 27, 102, 157, 152, 230, 40, 179, 56, 114, 23, 184, 193, 194, 84, 39, 116, 34, 18,
        40, 60, 44, 68, 128, 150, 128, 34, 116, 3, 14, 83, 58, 17, 95, 115, 131, 98, 23, 85, 84,
        218, 88, 192, 248, 40, 210, 135, 49, 54, 104, 170, 176, 191, 224, 112, 20, 140, 10, 213,
        250, 144, 233, 174, 132, 46, 175, 137, 163, 12, 69, 88, 120, 193, 76, 39, 10, 240, 163,
        200, 82, 154, 38, 87, 138, 186, 35, 42, 54, 36, 16, 157, 24, 212, 242, 64, 97, 38, 206,
        213, 209, 28, 54, 209, 87, 187, 104, 245, 218, 139, 148, 98, 178, 107, 143, 183, 107, 118,
        3, 54, 61, 27, 157, 157, 30, 159, 31, 158, 78, 78, 111, 71, 72, 39, 167, 23, 212, 219, 201,
        225, 233, 252, 120, 193, 31, 94, 175, 199, 6, 231, 230, 134, 71, 135, 39, 164, 244, 3, 196,
        219, 233, 201, 193, 201, 209, 193, 185, 177, 225, 245, 120, 62, 60, 30, 158, 141, 205, 191,
        108, 150, 54, 224, 66, 63, 10, 75, 122, 80, 103, 44, 73, 60, 187, 168, 25, 130, 2, 200,
        234, 246, 32, 244, 200, 145, 221, 151, 31, 61, 158, 111, 54, 148, 64, 162, 11, 129, 28, 65,
        21, 123, 124, 84, 56, 38, 85, 184, 78, 93, 184, 101, 148, 230, 6, 23, 52, 244, 114, 235,
        44, 92, 232, 64, 34, 128, 110, 128, 51, 128, 73, 21, 32, 107, 90, 54, 35, 122, 144, 8, 148,
        34, 154, 49, 37, 18, 36, 198, 212, 64, 101, 213, 129, 96, 172, 72, 49, 146, 192, 149, 44,
        48, 146, 52, 99, 160, 235, 65, 96, 127, 202, 93, 97, 32, 134, 203, 11, 95, 148, 122, 208,
        197, 115, 106, 182, 196, 64, 140, 141, 8, 112, 25, 22, 253, 23, 188, 218, 138, 163, 43,
        224, 132, 37, 112, 101, 200, 184, 232, 64, 42, 60, 166, 172, 178, 200, 120, 20, 212, 83, 9,
        8, 29, 152, 131, 13, 75, 232, 210, 122, 182, 202, 240, 200, 161, 193, 161, 3, 119, 104,
        225, 66, 40, 73, 52, 8, 19, 39, 111, 31, 104, 233, 192, 35, 31, 112, 240, 134, 64, 151, 89,
        147, 49, 71, 164, 97, 29, 24, 100, 6, 34, 73, 0, 32, 201, 0, 204, 111, 3, 32, 168, 116, 96,
        22, 215, 114, 196, 11, 13, 7, 61, 47, 146, 88, 38, 61, 56, 36, 215, 131, 193, 232, 172,
        189, 18, 162, 42, 96, 66, 7, 182, 16, 115, 35, 231, 75, 1, 34, 58, 39, 38, 52, 48, 210,
        129, 89, 148, 220, 217, 161, 205, 165, 13, 224, 51, 71, 183, 236, 191, 53, 59, 201, 41, 85,
        198, 224, 52, 98, 53, 132, 168, 160, 255, 182, 212, 120, 177, 137, 208, 3, 25, 21, 63, 36,
        102, 57, 116, 32, 82, 17, 52, 58, 94, 185, 9, 150, 174, 100, 32, 93, 251, 47, 0, 45, 96,
        100, 73, 22, 176, 176, 64, 77, 114, 139, 209, 133, 214, 76, 221, 141, 5, 157, 48, 169, 106,
        174, 153, 178, 163, 15, 57, 177, 80, 197, 204, 24, 47, 56, 122, 32, 17, 231, 154, 245, 159,
        14, 41, 99, 60, 85, 196, 120, 1, 185, 210, 120, 32, 237, 67, 73, 76, 53, 61, 217, 49, 3,
        110, 174, 75, 71, 145, 7, 253, 247, 194, 145, 6, 180, 176, 248, 130, 220, 242, 35, 204,
        152, 52, 61, 216, 133, 3, 57, 125, 91, 2, 168, 6, 251, 208, 252, 232, 193, 158, 226, 233,
        238, 9, 13, 167, 56, 184, 12, 176, 86, 200, 117, 97, 208, 20, 32, 122, 68, 162, 195, 0,
        144, 172, 212, 245, 62, 20, 226, 116, 234, 88, 119, 36, 176, 16, 164, 227, 149, 166, 11,
        193, 0, 1, 112, 6, 75, 19, 144, 177, 132, 229, 5, 5, 116, 32, 15, 49, 72, 170, 118, 40,
        225, 242, 60, 61, 152, 135, 254, 115, 162, 36, 36, 199, 89, 123, 23, 5, 135, 1, 40, 220,
        129, 22, 28, 115, 96, 18, 126, 84, 20, 37, 113, 66, 128, 13, 15, 250, 208, 220, 153, 245,
        234, 68, 129, 105, 168, 161, 48, 197, 16, 66, 200, 12, 8, 128, 130, 32, 8, 10, 225, 28, 80,
        208, 81, 167, 5, 162, 80, 36, 194, 225, 81, 111, 205, 16, 128, 64, 64, 67, 63, 0, 253, 158,
        76, 60, 255, 184, 93, 96, 212, 127, 82, 182, 211, 81, 11, 58, 120, 48, 240, 126, 200, 91,
        103, 44, 71, 183, 169, 174, 33, 0, 37, 118, 25, 101, 57, 129, 45, 109, 68, 168, 39, 95, 24,
        236, 171, 77, 127, 61, 114, 116, 183, 119, 65, 1, 216, 1, 212, 71, 130, 169, 235, 163, 240,
        135, 107, 181, 17, 14, 1, 30, 180, 255, 108, 203, 146, 61, 246, 81, 145, 245, 224, 234,
        107, 132, 116, 177, 129, 228, 245, 93, 164, 31, 155, 136, 245, 209, 163, 217, 125, 246, 57,
        115, 87, 27, 178, 215, 39, 184, 101, 152, 17, 185, 123, 14, 88, 145, 209, 208, 47, 153,
        247, 77, 186, 0, 9, 113, 109, 177, 182, 68, 171, 59, 16, 216, 211, 105, 52, 122, 189, 94,
        175, 45, 90, 195, 45, 215, 235, 245, 218, 170, 21, 107, 225, 218, 77, 10, 238, 16, 170,
        148, 0, 154, 67, 50, 124, 169, 240, 242, 192, 135, 138, 184, 182, 176, 186, 182, 88, 91,
        92, 91, 172, 45, 90, 11, 88, 172, 215, 235, 245, 122, 189, 182, 184, 182, 176, 106, 133,
        213, 197, 218, 179, 92, 91, 180, 166, 151, 146, 139, 93, 217, 68, 187, 17, 189, 42, 65, 14,
        83, 111, 34, 121, 199, 68, 111, 194, 245, 110, 52, 53, 244, 22, 238, 102, 132, 206, 239,
        13, 134, 148, 37, 84, 233, 188, 49, 143, 111, 30, 179, 200, 151, 216, 33, 248, 178, 41,
        212, 144, 244, 70, 8, 36, 229, 226, 56, 143, 48, 254, 77, 123, 177, 143, 235, 49, 214, 172,
        222, 25, 58, 52, 71, 79, 26, 237, 246, 132, 77, 82, 138, 53, 91, 178, 237, 218, 192, 169,
        93, 47, 246, 163, 177, 146, 196, 213, 26, 0, 197, 124, 73, 121, 105, 151, 168, 183, 81,
        180, 41, 54, 207, 108, 98, 203, 79, 190, 144, 63, 148, 104, 72, 173, 76, 154, 112, 189, 30,
        47, 134, 10, 229, 150, 241, 100, 29, 250, 141, 249, 91, 162, 165, 78, 145, 100, 17, 237,
        149, 15, 143, 21, 156, 233, 189, 181, 64, 248, 74, 223, 223, 64, 66, 237, 66, 120, 70, 175,
        190, 56, 75, 147, 78, 129, 255, 162, 18, 193, 27, 92, 203, 71, 175, 93, 62, 148, 205, 193,
        73, 72, 233, 219, 236, 4, 52, 68, 1, 170, 108, 132, 114, 34, 85, 132, 227, 204, 73, 183,
        175, 85, 196, 50, 253, 13, 18, 236, 229, 144, 124, 49, 162, 92, 32, 138, 56, 60, 6, 67,
        135, 232, 246, 122, 183, 157, 100, 238, 149, 198, 235, 144, 193, 49, 119, 24, 203, 79, 33,
        127, 152, 64, 78, 103, 159, 91, 170, 126, 73, 141, 114, 43, 53, 176, 118, 33, 98, 237, 96,
        86, 150, 194, 241, 251, 222, 79, 97, 201, 11, 136, 205, 158, 34, 164, 109, 200, 158, 55,
        180, 0, 95, 122, 235, 166, 135, 44, 180, 4, 141, 182, 215, 34, 69, 203, 125, 6, 66, 85,
        158, 26, 138, 55, 63, 205, 171, 25, 244, 122, 208, 71, 203, 112, 28, 12, 146, 116, 156,
        192, 152, 51, 249, 66, 67, 92, 137, 89, 159, 173, 234, 1, 46, 181, 105, 222, 72, 57, 190,
        148, 67, 116, 71, 227, 50, 86, 98, 19, 230, 122, 1, 238, 182, 145, 229, 90, 203, 210, 26,
        238, 173, 223, 24, 206, 8, 32, 36, 22, 40, 99, 15, 104, 12, 77, 249, 60, 155, 193, 101, 12,
        44, 50, 228, 87, 163, 0, 34, 170, 137, 248, 161, 103, 12, 108, 60, 250, 203, 255, 17, 32,
        110, 212, 153, 103, 93, 74, 10, 5, 148, 175, 198, 12, 251, 142, 156, 60, 159, 130, 124, 99,
        12, 194, 41, 214, 31,
    ];
    let graph = GraphJS::try_from(data);

    match graph {
        Ok(graph) => {
            assert_eq!(graph.num_vertices(), 77);
            assert_eq!(graph.num_edges(), 254);
        }
        Err(_) => panic!("Error reading graph"),
    }
}
